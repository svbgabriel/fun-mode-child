<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Fun Mode Child</title>
        <link rel="stylesheet" href="/webjars/bootstrap/5.3.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="/assets/css/fmc.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
        <script src="/webjars/bootstrap/5.3.2/js/bootstrap.min.js"></script>
    </head>
    <body>
    <div th:replace="~{fragments/fragments :: header}"></div>
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h2>Meu carrinho</h2>
            <p th:if="${cart.lista.isEmpty()}">Seu carrinho de compras está vazio!</p>
            <form th:if="${!cart.lista.isEmpty()}" method="post" action="/cart">
                <table class="table">
                    <tr>
                        <th>Item</th>
                        <th style="width:150px;">Quantidade</th>
                        <th style="width:150px;" class="text-right">Preço Unitário</th>
                        <th style="width:150px;" class="text-right">Valor</th>
                        <th style="width:30px;">&nbsp;</th>
                    </tr>
                    <tr th:each="product : ${products}">
                        <td th:text="${product.product().getName}"></td>
                        <td>
                            <input type="hidden" name="skualt" th:value="${product.product().id}" />
                            <input type="text" name="qtde" th:value="${product.quantity()}" class="form-control text-right" />
                        </td>
                        <td class="text-right" th:text="'$ ' + ${product.product().formatPrice()}"></td>
                        <td class="text-right" th:text="'$ ' + ${product.formatTotalPrice()}"></td>
                        <td><button type="button" class="btn btn-danger btn-xs" th:onclick="'removeItem('+${product.product().sku}+');'"><span class="bi-trash"></span></button></td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td class="text-right"><strong>Total</strong></td>
                        <td class="text-right" th:text="'$ ' + ${totalPrice}"></td>
                        <td>&nbsp;</td>
                    </tr>
                </table>
                <div class="row">
                    <div class="col-md-8">
                        <th:block th:if="${messages != null && messages.size() > 0}">
	                        <span class="label label-warning">Atenção!</span>
	                        <ul>
	                            <li th:each="message: ${messages}" th:utext="${message}"></li>
	                        </ul>
                        </th:block>
                    </div>
                    <div class="col-md-4 text-right">
                        <button type="submit" class="btn btn-info" name="alt" value="1"><span class="bi-floppy"></span> Salvar alterações</button>
                        <button type="button" class="btn btn-primary" onclick="document.location.href = '/payment';"><span class="bi-chevron-right"></span> Finalizar compra</button>
                    </div>
                </div>
            </form>
            <button type="button" class="btn btn-success mg-top-50" onclick="document.location.href = '/';"><span class="bi-chevron-left"></span> Continuar comprando</button>
        </div>
    </div>
</div>

<script>
    function removeItem(sku) {
        document.location.href = "/cart?del=1&sku=" + sku;
    }
</script>
</body>
</html>
